# ğŸ—ï¸ ClubFacts Architecture com Swagger

## Arquitetura Visual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLIENT / BROWSER                         â”‚
â”‚                                                             â”‚
â”‚  1. Swagger UI (http://localhost:8080/api-docs)           â”‚
â”‚  2. REST Client (Postman, curl, Thunder Client)           â”‚
â”‚  3. Web Browser                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP Requests
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXPRESS SERVER                           â”‚
â”‚                  (src/server.ts)                            â”‚
â”‚                                                             â”‚
â”‚  PORT: 8080                                                â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Middleware Layer (initMiddleware)                    â”‚  â”‚
â”‚  â”‚ - CORS                                               â”‚  â”‚
â”‚  â”‚ - JSON Parser                                        â”‚  â”‚
â”‚  â”‚ - Method Override                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Swagger UI Configuration (src/config/swagger.ts)    â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ GET /api-docs â”€â”€â”€â”€â”€â”€â–º Swagger UI                     â”‚  â”‚
â”‚  â”‚ POST /api-docs â”€â”€â”€â”€â–º Swagger JSON Spec               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Routes Layer (presentation/routes/)                  â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚  GET  /health              â”€â”€â–º HealthController     â”‚  â”‚
â”‚  â”‚  GET  /                    â”€â”€â–º WelcomeController    â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚  POST /auth/signin         â”€â”€â–º SignInController     â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚  GET  /orders              â”€â”€â–º GetAllOrderCtrl       â”‚  â”‚
â”‚  â”‚  POST /orders              â”€â”€â–º CreateOrderCtrl       â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚  (All documented with @swagger annotations)         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Auth Middleware (middlewares/authentication)        â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Validates Bearer Token (JWT)                         â”‚  â”‚
â”‚  â”‚ Required for: /orders endpoints                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Controllers Layer (presentation/controllers/)       â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Receives request â†’ Calls use case â†’ Returns response â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Use Cases Layer (usercase/)                         â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Business Logic Implementation                        â”‚  â”‚
â”‚  â”‚ - SignIn                                             â”‚  â”‚
â”‚  â”‚ - CreateOrder                                        â”‚  â”‚
â”‚  â”‚ - GetAllOrder                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Domain Layer (domain/)                               â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Models:                                              â”‚  â”‚
â”‚  â”‚ - User                                               â”‚  â”‚
â”‚  â”‚ - Order                                              â”‚  â”‚
â”‚  â”‚ - OrderItem                                          â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Repositories (Interfaces):                           â”‚  â”‚
â”‚  â”‚ - IUserRepository                                    â”‚  â”‚
â”‚  â”‚ - IOrderRepository                                   â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Providers (Interfaces):                              â”‚  â”‚
â”‚  â”‚ - ITokenProvider (JWT)                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Infrastructure Layer (infra/)                       â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Database:                                            â”‚  â”‚
â”‚  â”‚ - Prisma ORM                                         â”‚  â”‚
â”‚  â”‚ - PostgreSQL / SQLite                                â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Authentication:                                      â”‚  â”‚
â”‚  â”‚ - JsonWebTokenProvider                               â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ External Services:                                   â”‚  â”‚
â”‚  â”‚ - WhatsApp (Evolution API)                           â”‚  â”‚
â”‚  â”‚ - Kafka Messaging                                    â”‚  â”‚
â”‚  â”‚ - Node-Cron Scheduler                                â”‚  â”‚
â”‚  â”‚ - Cache (Memory, Redis)                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Factories Layer (infra/factories/)                   â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Dependency Injection                                 â”‚  â”‚
â”‚  â”‚ - Controller Factories                               â”‚  â”‚
â”‚  â”‚ - Repository Factories                               â”‚  â”‚
â”‚  â”‚ - Middleware Factories                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Database Queries
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATABASE                               â”‚
â”‚                                                             â”‚
â”‚  Prisma ORM                                                â”‚
â”‚  â”œâ”€ Users Table                                            â”‚
â”‚  â”œâ”€ Orders Table                                           â”‚
â”‚  â””â”€ Other Tables...                                        â”‚
â”‚                                                             â”‚
â”‚  PostgreSQL / SQLite                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Fluxo de RequisiÃ§Ã£o com Swagger

```
1. DOCUMENTAÃ‡ÃƒO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Swagger UI             â”‚
   â”‚  /api-docs              â”‚
   â”‚                         â”‚
   â”‚ - Visualiza rotas       â”‚
   â”‚ - Testa endpoints       â”‚
   â”‚ - Copia exemplos        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
2. AUTENTICAÃ‡ÃƒO (se necessÃ¡rio)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  POST /auth/signin      â”‚
   â”‚  (email, password)      â”‚
   â”‚                         â”‚
   â”‚ Response: JWT Token     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
3. REQUISIÃ‡ÃƒO AUTENTICADA
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  GET /orders            â”‚
   â”‚  Header:                â”‚
   â”‚  Authorization: Bearer  â”‚
   â”‚  <jwt_token>            â”‚
   â”‚                         â”‚
   â”‚ Auth Middleware:        â”‚
   â”‚ â”œâ”€ Valida token         â”‚
   â”‚ â”œâ”€ Extrai userId        â”‚
   â”‚ â””â”€ Passa para controllerâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
4. PROCESSAMENTO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  GetAllOrderController  â”‚
   â”‚  â†’ GetAllOrder UseCase  â”‚
   â”‚  â†’ IOrderRepository     â”‚
   â”‚  â†’ Database Query       â”‚
   â”‚                         â”‚
   â”‚ Response: Order[]       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
5. RESPOSTA
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  JSON Response          â”‚
   â”‚  Status: 200            â”‚
   â”‚  Body: [orders...]      â”‚
   â”‚                         â”‚
   â”‚  Exibido no Swagger UI  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## IntegraÃ§Ã£o Swagger no CÃ³digo

```typescript
// src/app.ts
import swaggerUi from "swagger-ui-express";
import { swaggerSpec } from "./config/swagger";

const server = async () => {
    const app = express();
    initMiddleware(app);
    
    // â† Swagger estÃ¡ aqui!
    app.use("/api-docs", swaggerUi.serve, swaggerUi.setup(swaggerSpec));
    
    initRoutes(app);
    return app;
}
```

```typescript
// src/presentation/routes/auth.routes.ts
/**
 * @swagger
 * /auth/signin:
 *   post:
 *     summary: Sign in user
 *     requestBody:
 *       required: true
 *       content:
 *         application/json:
 *           schema:
 *             type: object
 *             properties:
 *               email: { type: string, format: email }
 *               password: { type: string, format: password }
 *     responses:
 *       200:
 *         description: Sign in successful
 */
export function makeAuthRoutes(...) { ... }
```

## Componentes da DocumentaÃ§Ã£o Swagger

```json
{
  "openapi": "3.0.0",
  "info": {
    "title": "ClubFacts API",
    "version": "1.0.0"
  },
  "servers": [
    { "url": "http://localhost:8080" }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": { "type": "http", "scheme": "bearer" }
    },
    "schemas": {
      "User": { /* modelo de dados */ },
      "Order": { /* modelo de dados */ },
      "OrderItem": { /* modelo de dados */ }
    }
  },
  "paths": {
    "/auth/signin": { /* definiÃ§Ã£o do endpoint */ },
    "/orders": { /* definiÃ§Ã£o do endpoint */ }
  }
}
```

## Fluxo de Desenvolvimento

```
â”Œâ”€ Desenvolvimento
â”‚  â””â”€ Editar rota em src/presentation/routes/
â”‚     â””â”€ Adicionar anotaÃ§Ã£o @swagger
â”‚        â””â”€ npm run dev
â”‚           â””â”€ Swagger atualiza automaticamente
â”‚              â””â”€ Acessar http://localhost:8080/api-docs
â””â”€ DocumentaÃ§Ã£o gerada automaticamente!
```
